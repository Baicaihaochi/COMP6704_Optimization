\documentclass{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{hyperref}
\geometry{a4paper, margin=1in}

\title{Exact and Heuristic Methods for the Berlin52 Traveling Salesman Problem}
\author{}
\date{}

\begin{document}
\maketitle

\begin{abstract}
We study the classic Euclidean Traveling Salesman Problem (TSP) on the Berlin52 TSPLIB instance. We present a rigorous mathematical formulation aligned with TSPLIB rounding, and evaluate four methods that all run on Berlin52: a greedy Nearest Neighbor construction with 2-opt local search, an exact Integer Linear Programming approach with two execution modes (lazy subtour elimination via branch-and-cut and an MTZ fallback), a Genetic Algorithm with permutation encoding, and a Simulated Annealing metaheuristic with a 2-opt neighborhood. We additionally include the Held--Karp dynamic programming recurrence as a theoretical appendix to contextualize limits of exact dynamic programming. We outline an experimental protocol to compare solution quality, optimality gap, and runtime against the known optimum 7542.
\end{abstract}

\section{Introduction}
The Traveling Salesman Problem (TSP) seeks a minimum-length Hamiltonian cycle visiting each city exactly once. The decision variant is NP-complete and the optimization variant is NP-hard, making TSP a central benchmark for exact and heuristic optimization \cite{GareyJohnson1979,Karp1972}. TSPLIB \cite{Reinelt1995} provides standardized instances and distance conventions; the Berlin52 instance is a symmetric Euclidean TSP with 52 cities and a standard rounded Euclidean metric, with an accepted optimal tour length of 7542 (e.g., established by Concorde \cite{Applegate2006Concorde}). Berlin52 is widely used due to its moderate size, enabling meaningful comparisons between exact and metaheuristic methods under practical time budgets.

This paper makes three contributions: (i) a precise problem formulation using TSPLIB rounding; (ii) four Berlin52-ready methods covering constructive heuristics (Nearest Neighbor with 2-opt), metaheuristics (Genetic Algorithm, Simulated Annealing), and exact ILP in dual modes (lazy SEC branch-and-cut and MTZ); and (iii) a clear, reproducible experimental design. A dynamic programming (Held--Karp) formulation \cite{HeldKarp1962,Bellman1962} appears in the appendix for completeness but is not executed at full size due to exponential state growth.

\section{Problem Formulation}
Let $\mathcal{V}=\{1, \dots, n\}$, $n=52$, denote cities with coordinates $(x_i,y_i)$. TSPLIB's rounded Euclidean distance is
\begin{equation}
 d_{ij}=d_{ji}=\left\lfloor \sqrt{(x_i-x_j)^2+(y_i-y_j)^2}+\tfrac{1}{2} \right\rfloor,\quad i\neq j,\qquad d_{ii}=0.
\end{equation}

\paragraph{Symmetric cutset ILP (for lazy SEC).}
Use binary edge variables for the undirected graph: $x_{ij}\in\{0,1\}$ for $1\le i<j\le n$. The TSP can be written as
\begin{align}
\min\ & \sum_{1\le i<j\le n} d_{ij}\, x_{ij} \\
\text{s.t. }& \sum_{\substack{j=1\\ j\ne i}}^n x_{\min(i,j),\max(i,j)}=2, && \forall i\in\mathcal{V} \quad \text{(degree)} \\
& \sum_{\substack{i\in S,\ j\notin S\\ i<j}} x_{ij}+\sum_{\substack{i\in S,\ j\notin S\\ i>j}} x_{ji} \ge 2, && \forall S\subset\mathcal{V},\ 3\le |S| \le n-3 \quad \text{(SEC)} \\
& x_{ij}\in\{0,1\}, && 1\le i<j\le n.
\end{align}
The subtour elimination constraints (SEC) are separated lazily in our branch-and-cut mode by detecting subtours in candidate integer solutions.

\paragraph{Directed MTZ ILP (fallback).}
Introduce binary arc variables $y_{ij}\in\{0,1\}$ for $i\ne j$, and ordering variables $u_i$ with $u_1=1$, $2\le u_i\le n$ for $i\ge 2$. The MTZ model is
\begin{align}
\min\ & \sum_{\substack{i,j\in\mathcal{V}\\ i\ne j}} d_{ij}\, y_{ij} \\
\text{s.t. }& \sum_{j\ne i} y_{ij}=1,\ \sum_{i\ne j} y_{ij}=1, && \forall i\in\mathcal{V} \quad \text{(in/out-degree)} \\
& u_i - u_j + n\, y_{ij} \le n-1, && \forall i\ne j,\ i\ge 2,\ j\ge 2 \quad \text{(MTZ)} \\
& u_1=1,\ 2\le u_i\le n, && i\ge 2, \\
& y_{ij}\in\{0,1\}, && i\ne j.
\end{align}
This eliminates subtours without callbacks and is suitable for open-source solvers; it is weaker than cutset SEC but practical at $n=52$ with time limits.

\section{Methods}
All four methods in this section are executable on Berlin52. We provide rigorous definitions, algorithmic steps, complexity, and termination criteria.

\subsection{Nearest Neighbor + 2-opt}
Let a tour be a cyclic permutation $\pi=\langle \pi_1,\dots,\pi_n\rangle$. The Nearest Neighbor (NN) heuristic \cite{Flood1956,Rosenkrantz1977} constructs a Hamiltonian cycle by fixing a start city $\pi_1=s$ (e.g., $s=1$) and iteratively appending the closest unvisited city according to
\begin{equation}
 \pi_{k+1}=\arg\min_{j\in \mathcal{V}\setminus\{\pi_1,\dots,\pi_k\}} d_{\pi_k j}.
\end{equation}
The resulting tour is refined by 2-opt local search \cite{Croes1958}. For indices $1\le i<j\le n$ (with $\pi_{n+1}\equiv\pi_1$), we consider exchanging edges $(\pi_i,\pi_{i+1})$ and $(\pi_j,\pi_{j+1})$; if
\begin{equation}
 \Delta=\big(d_{\pi_i\pi_{i+1}}+d_{\pi_j\pi_{j+1}}\big)-\big(d_{\pi_i\pi_j}+d_{\pi_{i+1}\pi_{j+1}}\big) > 0,
\end{equation}
we reverse the subpath $\langle \pi_{i+1},\dots,\pi_j\rangle$ to obtain an improving tour. We adopt a first-improvement scanning scheme and terminate when a complete pass produces no improvement, or after a prescribed maximum number of passes $K_{\max}$. The NN construction costs $O(n^2)$ time, a full 2-opt pass costs $O(n^2)$, and for $n=52$ the number of improving passes is typically small in practice.

\subsection{ILP (Lazy SEC + MTZ)}
To obtain exact solutions, we employ an integer linear programming approach in two modes. In the lazy subtour elimination mode based on the DFJ formulation \cite{DFJ1954}, we solve the symmetric degree-only relaxation and, whenever the solver finds an integer incumbent $x^*$, we form the graph $G^*=(\mathcal{V},E^*)$ with $E^*=\{\{i,j\}:x^*_{ij}=1\}$, detect subtours (e.g., via connected components), and add the corresponding cutset inequalities. This branch-and-cut procedure \cite{PadbergRinaldi1991,Applegate2006Concorde} iterates until optimality is certified or a time limit is reached. When callback-based lazy constraints are unavailable, we fall back to the directed MTZ formulation \cite{MTZ1960} with arc variables and order variables, which eliminates subtours without separation. We declare optimality when the reported MIP gap is zero; otherwise, after a preset time limit $\tau$ we report the incumbent solution and its gap. Although the worst-case complexity is exponential, Berlin52 is tractable in practice with modern MIP solvers.

\subsection{Genetic Algorithm}
We adopt a permutation-encoded genetic algorithm \cite{Goldberg1989} in which each chromosome is a tour $\mathbf{p}=\langle p_1,\dots,p_n\rangle$. The fitness is taken as the inverse tour length, $f(\mathbf{p})=1/L(\mathbf{p})$, with $L(\mathbf{p})=\sum_{k=1}^{n-1} d_{p_k p_{k+1}}+d_{p_n p_1}$. Parent selection uses tournament sampling of size $k$, promoting fitter tours while maintaining diversity. Offspring are generated by order crossover (OX) \cite{Davis1985}: a contiguous segment from one parent is copied into the child, and the remaining positions are filled by scanning the other parent and inserting cities in order while skipping duplicates. Mutation maintains exploration by either inverting a randomly chosen subsequence or swapping two randomly chosen positions \cite{Michalewicz1996}. To intensify search, an optional memetic step applies 2-opt to the top fraction of the population every fixed number of generations. The algorithm runs for a prescribed number of generations $G$ or terminates early if the best fitness has not improved for $S$ consecutive generations. The computational effort scales as $O(\text{pop}\, G\, (n + C_{2\text{-opt}}))$, where $C_{2\text{-opt}}$ denotes the amortized cost of local improvement when enabled.

\subsection{Simulated Annealing}
We implement simulated annealing over the 2-opt neighborhood \cite{Kirkpatrick1983,Cerny1985}. Candidate tours are proposed by random 2-opt reversals, and a candidate of cost $L'$ is accepted from a current tour of cost $L$ with Metropolis probability
\begin{equation}
 \Pr(\text{accept})=\min\{1,\exp(-(L'-L)/T)\}.
\end{equation}
The temperature follows a geometric schedule $T_{t+1}=\alpha T_t$ with $\alpha\in(0,1)$ and a fixed number of evaluations per temperature level. Initialization uses either an NN tour or a random permutation; the initial temperature $T_0$ is set from a percentile of sampled positive 2-opt cost increases so that uphill moves are initially accepted with reasonable probability. We terminate when $T<10^{-3}$ or when the best solution has not improved for 10 consecutive temperature levels, or earlier if a time or iteration budget is reached. Letting $I$ denote the total number of evaluated proposals, the overall time is $O(I)$, using constant-time incremental updates for 2-opt move evaluation.

\section{Experiments}
We evaluate all four methods on Berlin52.

\textbf{Dataset.} TSPLIB Berlin52 with rounded Euclidean distances.

\textbf{Metrics.} Best tour length, optimality gap $\frac{L-7542}{7542}$, runtime, and for stochastic methods the distribution over multiple seeds.

\textbf{Protocol.} For GA and SA, run at least 10 seeds; for ILP, use a time limit $\tau$ (e.g., 15--20 minutes) and report incumbent and MIP gap; for NN+2-opt, report result from several start cities. We will include convergence plots and tour visualizations.

\textbf{Default parameters.} Example defaults: GA (population 100, generations 500, tournament $k=3$, $p_c=0.9$, $p_m=0.2$, elitism 2, memetic 2-opt on top 10% every 10 generations); SA ($T_0$ from median positive 2-opt $\Delta$, $\alpha=0.98$, 20$n$ moves per temperature, termination as above); NN+2-opt (first-improvement, capped passes); ILP (lazy SEC if available; otherwise MTZ; time limit $\tau$).

\section{Conclusion}
We presented four Berlin52-executable methods spanning constructive heuristics, metaheuristics, and exact ILP with two execution modes, and we specified termination criteria and an evaluation protocol against the known optimum. Next, we will run the experiments, analyze quality--time trade-offs, and quantify the impact of local improvement and solver mode.

\appendix
\section{Held--Karp Dynamic Programming (Theoretical)}
Fix city 1 as origin. For $S\subseteq \mathcal{V}\setminus\{1\}$ and $j\in S$, define
\begin{equation}
 C(S,j)=\begin{cases}
 d_{1j}, & S=\{j\},\\
 \min\limits_{k\in S\setminus\{j\}} \big( C(S\setminus\{j\},k)+d_{kj}\big), & |S|\ge 2.
 \end{cases}
\end{equation}
The optimal tour cost is $\min_{j\ne 1}\big(C(\mathcal{V}\setminus\{1\},j)+d_{j1}\big)$ \cite{HeldKarp1962,Bellman1962}. The complexity is $O(n^2 2^n)$ time and $O(n2^n)$ space, which is infeasible for $n=52$; however, it is useful for validating small subsets.

\begin{thebibliography}{99}
\bibitem{GareyJohnson1979} M. R. Garey and D. S. Johnson. Computers and Intractability: A Guide to the Theory of NP-Completeness. W. H. Freeman, 1979.
\bibitem{Karp1972} R. M. Karp. Reducibility among combinatorial problems. In Complexity of Computer Computations, 1972.
\bibitem{Reinelt1995} G. Reinelt. TSPLIB—A traveling salesman problem library. ORSA Journal on Computing, 3(4):376–384, 1991. (TSPLIB95 updated online collection).
\bibitem{Applegate2006Concorde} D. L. Applegate, R. E. Bixby, V. Chvátal, and W. J. Cook. The Traveling Salesman Problem: A Computational Study. Princeton University Press, 2006. (See also the Concorde TSP Solver website.).
\bibitem{HeldKarp1962} M. Held and R. M. Karp. A dynamic programming approach to sequencing problems. Journal of the Society for Industrial and Applied Mathematics, 10(1):196–210, 1962.
\bibitem{Bellman1962} R. Bellman. Dynamic programming treatment of the traveling salesman problem. Journal of the ACM, 9(1):61–63, 1962.
\bibitem{Flood1956} M. M. Flood. The traveling-salesman problem. Operations Research, 4(1):61–75, 1956.
\bibitem{Rosenkrantz1977} D. J. Rosenkrantz, R. E. Stearns, and P. M. Lewis. An analysis of several heuristics for the traveling salesman problem. SIAM Journal on Computing, 6(3):563–581, 1977.
\bibitem{Croes1958} G. A. Croes. A method for solving traveling-salesman problems. Operations Research, 6(6):791–812, 1958.
\bibitem{DFJ1954} G. B. Dantzig, R. Fulkerson, and S. Johnson. Solution of a large-scale traveling-salesman problem. Operations Research, 2(4):393–410, 1954.
\bibitem{PadbergRinaldi1991} M. W. Padberg and G. Rinaldi. A branch-and-cut algorithm for the resolution of large-scale symmetric traveling salesman problems. SIAM Review, 33(1):60–100, 1991.
\bibitem{MTZ1960} C. E. Miller, A. W. Tucker, and R. A. Zemlin. Integer programming formulation of traveling salesman problems. Journal of the ACM, 7(4):326–329, 1960.
\bibitem{Goldberg1989} D. E. Goldberg. Genetic Algorithms in Search, Optimization and Machine Learning. Addison-Wesley, 1989.
\bibitem{Davis1985} L. Davis. Applying adaptive algorithms to epistatic domains. IJCAI, 1985. (Introduces the order crossover operator.)
\bibitem{Michalewicz1996} Z. Michalewicz. Genetic Algorithms + Data Structures = Evolution Programs. Springer, 3rd ed., 1996.
\bibitem{Kirkpatrick1983} S. Kirkpatrick, C. D. Gelatt, and M. P. Vecchi. Optimization by simulated annealing. Science, 220(4598):671–680, 1983.
\bibitem{Cerny1985} V. Černý. Thermodynamical approach to the traveling salesman problem: An efficient simulation algorithm. Journal of Optimization Theory and Applications, 45(1):41–51, 1985.
\end{thebibliography}

\end{document}
