\documentclass{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{hyperref}
\geometry{a4paper, margin=1in}

\title{Exact and Heuristic Methods for the Berlin52 Traveling Salesman Problem}
\author{}
\date{}

\begin{document}
\maketitle

\begin{abstract}
We study the classic Euclidean Traveling Salesman Problem (TSP) on the Berlin52 TSPLIB instance. We present a rigorous mathematical formulation aligned with TSPLIB rounding, and evaluate four methods that all run on Berlin52: a greedy Nearest Neighbor construction with 2-opt local search, an exact Integer Linear Programming approach with two execution modes (lazy subtour elimination via branch-and-cut and an MTZ fallback), a Genetic Algorithm with permutation encoding, and a Simulated Annealing metaheuristic with a 2-opt neighborhood. We additionally include the Held--Karp dynamic programming recurrence as a theoretical appendix to contextualize limits of exact dynamic programming. We outline an experimental protocol to compare solution quality, optimality gap, and runtime against the known optimum 7542.
\end{abstract}

\section{Introduction}
The Traveling Salesman Problem (TSP) seeks a minimum-length Hamiltonian cycle visiting each city exactly once. Despite its simple statement, TSP is NP-hard and a touchstone for both exact optimization and metaheuristics. The Berlin52 instance from TSPLIB provides 52 planar coordinates with the standard rounded Euclidean metric and a widely accepted optimal tour length of 7542 (e.g., verified by Concorde). Its moderate size enables meaningful comparisons between exact and heuristic methods within practical time limits.

This paper makes three contributions: (i) a precise problem formulation using TSPLIB rounding; (ii) four Berlin52-ready methods covering constructive heuristics, metaheuristics, and exact ILP in dual modes; and (iii) a clear, reproducible experimental design. A dynamic programming (Held--Karp) formulation appears in the appendix for completeness but is not executed at full size due to exponential state growth.

\section{Problem Formulation}
Let $\mathcal{V}=\{1, \dots, n\}$, $n=52$, denote cities with coordinates $(x_i,y_i)$. TSPLIB's rounded Euclidean distance is
\begin{equation}
 d_{ij}=d_{ji}=\left\lfloor \sqrt{(x_i-x_j)^2+(y_i-y_j)^2}+\tfrac{1}{2} \right\rfloor,\quad i\neq j,\qquad d_{ii}=0.
\end{equation}

\paragraph{Symmetric cutset ILP (for lazy SEC).}
Use binary edge variables for the undirected graph: $x_{ij}\in\{0,1\}$ for $1\le i<j\le n$. The TSP can be written as
\begin{align}
\min\ & \sum_{1\le i<j\le n} d_{ij}\, x_{ij} \\
\text{s.t. }& \sum_{\substack{j=1\\ j\ne i}}^n x_{\min(i,j),\max(i,j)}=2, && \forall i\in\mathcal{V} \quad \text{(degree)} \\
& \sum_{\substack{i\in S,\ j\notin S\\ i<j}} x_{ij}+\sum_{\substack{i\in S,\ j\notin S\\ i>j}} x_{ji} \ge 2, && \forall S\subset\mathcal{V},\ 3\le |S| \le n-3 \quad \text{(SEC)} \\
& x_{ij}\in\{0,1\}, && 1\le i<j\le n.
\end{align}
The subtour elimination constraints (SEC) are separated lazily in our branch-and-cut mode by detecting subtours in candidate integer solutions.

\paragraph{Directed MTZ ILP (fallback).}
Introduce binary arc variables $y_{ij}\in\{0,1\}$ for $i\ne j$, and ordering variables $u_i$ with $u_1=1$, $2\le u_i\le n$ for $i\ge 2$. The MTZ model is
\begin{align}
\min\ & \sum_{\substack{i,j\in\mathcal{V}\\ i\ne j}} d_{ij}\, y_{ij} \\
\text{s.t. }& \sum_{j\ne i} y_{ij}=1,\ \sum_{i\ne j} y_{ij}=1, && \forall i\in\mathcal{V} \quad \text{(in/out-degree)} \\
& u_i - u_j + n\, y_{ij} \le n-1, && \forall i\ne j,\ i\ge 2,\ j\ge 2 \quad \text{(MTZ)} \\
& u_1=1,\ 2\le u_i\le n, && i\ge 2, \\
& y_{ij}\in\{0,1\}, && i\ne j.
\end{align}
This eliminates subtours without callbacks and is suitable for open-source solvers; it is weaker than cutset SEC but practical at $n=52$ with time limits.

\section{Methods}
All four methods in this section are executable on Berlin52. We provide rigorous definitions, algorithmic steps, complexity, and termination criteria.

\subsection{Nearest Neighbor + 2-opt}
Let a tour be a cyclic permutation $\pi=\langle \pi_1,\dots,\pi_n\rangle$. The Nearest Neighbor (NN) constructor initializes $\pi_1=s$ (e.g., $s=1$) and iteratively selects
\begin{equation}
 \pi_{k+1}=\arg\min_{j\in \mathcal{V}\setminus\{\pi_1,\dots,\pi_k\}} d_{\pi_k j}.
\end{equation}
For 2-opt, for $1\le i<j\le n$ (with $\pi_{n+1}\equiv\pi_1$) consider swapping edges $(\pi_i,\pi_{i+1})$ and $(\pi_j,\pi_{j+1})$; accept if
\begin{equation}
 \Delta=\big(d_{\pi_i\pi_{i+1}}+d_{\pi_j\pi_{j+1}}\big)-\big(d_{\pi_i\pi_j}+d_{\pi_{i+1}\pi_{j+1}}\big) > 0,
\end{equation}
and reverse the subpath $\langle \pi_{i+1},\dots,\pi_j\rangle$.

\textbf{Termination.} Use first-improvement scans until a full pass yields no improving move, or until a maximum number of passes $K_{\max}$.

\textbf{Complexity.} NN construction is $O(n^2)$. A full 2-opt pass is $O(n^2)$; the number of improving passes is instance-dependent (typically small for $n=52$).

\subsection{ILP (Lazy SEC + MTZ)}
\textbf{Lazy-SEC mode.} Solve the symmetric degree-only model; when an integer solution $x^*$ is found, build $G^*=(\mathcal{V},E^*)$ with $E^*=\{\{i,j\}:x^*_{ij}=1\}$, detect connected components/subtours, and add the violated SECs. Iterate until optimality or time limit.

\textbf{MTZ fallback.} Solve the directed MTZ model with $y,u$ variables when lazy callbacks are unavailable.

\textbf{Termination.} Report optimality when the MIP gap is zero; otherwise stop at a preset time limit $\tau$ and report the best incumbent and MIP gap.

\textbf{Complexity.} Exponential in the worst case; practically effective on Berlin52 with a modern MIP solver.

\subsection{Genetic Algorithm}
\textbf{Encoding.} A chromosome is a permutation $\mathbf{p}=\langle p_1,\dots,p_n\rangle$.

\textbf{Fitness.} $f(\mathbf{p})=1/L(\mathbf{p})$ where $L(\mathbf{p})=\sum_{k=1}^{n-1} d_{p_k p_{k+1}}+d_{p_n p_1}$.

\textbf{Selection.} Tournament of size $k$ selects $\arg\max f$.

\textbf{Crossover (OX).} Choose cut points $a<b$; copy segment $p_a,\dots,p_b$ from parent 1; fill remaining positions by scanning parent 2 in order, skipping duplicates.

\textbf{Mutation (inversion or swap).} Pick indices $i<j$ and reverse $p_i,\dots,p_j$ (or swap two cities) with probability $p_m$.

\textbf{Local improvement (optional).} Apply 2-opt to the best $q\%$ individuals every $r$ generations (memetic GA).

\textbf{Termination.} Run for $G$ generations or stop early if no improvement for $S$ consecutive generations.

\textbf{Complexity.} $O\big(\text{pop}\times G\times (n + C_{2\text{-opt}})\big)$, where $C_{2\text{-opt}}$ is the amortized cost of local improvement when enabled.

\subsection{Simulated Annealing}
Let a move be a 2-opt reversal. Given current tour cost $L$ and candidate cost $L'$, accept with probability
\begin{equation}
 \mathbb{P}[\text{accept}]=\min\{1,\exp(-(L'-L)/T)\}.
\end{equation}
Use geometric cooling $T_{t+1}=\alpha T_t$ with $\alpha\in(0,1)$ and a fixed number of iterations per temperature level.

\textbf{Initialization.} Start from NN or a random permutation; set $T_0$ from a percentile of sampled 2-opt cost increases.

\textbf{Termination.} Stop when $T<10^{-3}$ or no improvement for 10 consecutive temperatures (as our default), or when a time/iteration budget is reached.

\textbf{Complexity.} Let $I$ be total move evaluations; complexity is $O(I)$ with $O(1)$ incremental 2-opt cost updates per proposal.

\section{Experiments}
We evaluate all four methods on Berlin52.

\textbf{Dataset.} TSPLIB Berlin52 with rounded Euclidean distances.

\textbf{Metrics.} Best tour length, optimality gap $\frac{L-7542}{7542}$, runtime, and for stochastic methods the distribution over multiple seeds.

\textbf{Protocol.} For GA and SA, run at least 10 seeds; for ILP, use a time limit $\tau$ (e.g., 15--20 minutes) and report incumbent and MIP gap; for NN+2-opt, report result from several start cities. We will include convergence plots and tour visualizations.

\textbf{Default parameters.} Example defaults: GA (population 100, generations 500, tournament $k=3$, $p_c=0.9$, $p_m=0.2$, elitism 2, memetic 2-opt on top 10% every 10 generations); SA ($T_0$ from median positive 2-opt $\Delta$, $\alpha=0.98$, 20$n$ moves per temperature, termination as above); NN+2-opt (first-improvement, capped passes); ILP (lazy SEC if available; otherwise MTZ; time limit $\tau$).

\section{Conclusion}
We presented four Berlin52-executable methods spanning constructive heuristics, metaheuristics, and exact ILP with two execution modes, and we specified termination criteria and an evaluation protocol against the known optimum. Next, we will run the experiments, analyze quality--time trade-offs, and quantify the impact of local improvement and solver mode.

\appendix
\section{Held--Karp Dynamic Programming (Theoretical)}
Fix city 1 as origin. For $S\subseteq \mathcal{V}\setminus\{1\}$ and $j\in S$, define
\begin{equation}
 C(S,j)=\begin{cases}
 d_{1j}, & S=\{j\},\\
 \min\limits_{k\in S\setminus\{j\}} \big( C(S\setminus\{j\},k)+d_{kj}\big), & |S|\ge 2.
 \end{cases}
\end{equation}
The optimal tour cost is $\min_{j\ne 1}\big(C(\mathcal{V}\setminus\{1\},j)+d_{j1}\big)$. The complexity is $O(n^2 2^n)$ time and $O(n2^n)$ space, which is infeasible for $n=52$; however, it is useful for validating small subsets.

\end{document}
